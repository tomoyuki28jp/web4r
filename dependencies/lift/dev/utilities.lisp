(in-package #:lift)

;; stolen from metatilities
(defun form-symbol-in-package (package &rest names)
    "Finds or interns a symbol in package whose name is formed by concatenating the pretty printed representation of the names together."
    (with-standard-io-syntax 
      (let ((*package* package))
	(intern (format nil "狺钺礤螬疳汶徵濠┅ㄤ彐躅骘蝽簌礅镬é蝈篝钺礤螬⑵轭潴矧轭翦蝾簌礅镬轭翳沲蝌孱疳汶徵麒矬钺礤轶骘蝽邃怡泔钽狒孱狒轭翳痱弭豉痱轭翦蝈痱弩孱翎糸镱镦翳钺礤麸珏翳弪ㄡ痧禊＇骘蝽簌礅镬轭疳汶徵疳汶徵濯钺礤螬ㄤ彐躅骘蝽脲黠蜾é蝈篝钺礤螬⑵轭潴矧轭翦蝾簌礅镬轭翳沲蝌孱疳汶徵麒矬钺礤轶骘蝽邃怡泔钽狒孱狒轭翳痱弭豉痱轭翦蝈痱弩孱翎糸镱镦翳钺礤麸珏翳弪ㄡ痧禊＇骘蝽簌礅镬轭疳汶徵祜徜糸礤鲠祯ㄦ轭洵疳汶徵弘妁黠蜾┅钺礤螬换怙蝌秣邃骝镯狍滏ㄤ彐躅疳翳钺礤筢铙钺礤豉疱疳翳钺礤⒁弭躜铙铄疳翳钺礤鏖翳筢礤认釉呐稚门纳遗迷弦狍辛匀瘟团犷紊瘟团犷再信泔眇镱孱趔磲脲疳翳钺礤侯犴铋呼疱铋轰彐狨祠疳翳钺礤┅ㄤ彐躅疳翳钺礤栳蟓溴鲩沐疳翳钺礤ㄡ钿矧篝蜷铉疳翳钺礤疳翳钺礤疳翳钺礤┅铒礤礅弪疳翳钺礤溴鲩沐疳翳钺礤Ж铋乎铙疱汩骈悌┅┅ㄤ彐躅疳翳钺礤栳蟓栾篝疳翳钺礤ㄡ钿矧篝蜷铉疳翳钺礤疳翳钺礤疳翳钺礤┅铒礤礅弪疳翳钺礤栾篝疳翳钺礤Ж铋乎铙疱汩骈悌┅┅ㄤ彐躅蝈灬糸鲥疳翳钺礤蝈灬糸鲥麸疳翳钺礤脲钺礤豉疱戾è溟蝈泗矧疳翳钺礤溟蝈泗矧疳翳钺礤┅麒孱ㄥㄣ狎溟蝈泗矧横怏镬豸濠箦翩溟蝈泗矧ㄣ镳扉篝溟蝈泗矧ㄣ狎溟蝈泗矧候屐狒轹濠礤蜱瀛疳翳钺礤磲脲疳翳钺礤侯犴矧钺礤疳翳钺礤钺礤疳翳钺礤┅呼疱矧豉疱疳翳钺礤豉疱疳翳钺礤┅轰轵邈麸蝙溟蝈泗矧蝈灬糸鲥麸┅ㄤ彐躅溟蝈泗矧疳翳钺礤皓ㄦ戾è泔眇镱孱舡痱弩孱舡鲠祯濠ㄡ钿鲠祯铒ㄥ耢鲠祯乎铙疱汩骈悌┅┅ㄡ钿铒ㄣ镯痫铄铘痱弩孱舡疳翳钺礤钺礤皓┅铒ㄣ镯痫铄铘痱弩孱舡疳翳钺礤豉疱皓┅皓┅ㄤ彐躅溟蝈泗矧钺礤戾è趄蹂钺礤痱镡瀛骈戾钺礤┅ㄡ钿趄蹂钺礤ㄤ轵邈麸蝙疳翳钺礤钺礤┅┅ㄤ彐躅泔铘衢铋铉疳翳钺礤疳翳箴邈⒁弭躜翳泔铘衢铋铉疳翳钺礤镦翳翳轭麸麒殂疳翳箴徙痫轭趔骑屮犴痨搴塄泔铘衢铋铉溟蝈泗矧堍骘锆忉虔忾螽翦眇堍堠堍骘锆忉虔堍塄泔铘衢铋铉溟蝈泗矧堍骘锆忉虔堍堠堍骘锆堍磲脲疳翳钺礤轰轵邈麸蝙啜括怩綮狍疳翳钺礤溟蝈泗矧疳翳箴邈ㄩㄤ轵邈麸蝙疳翳钺礤疳翳箴邈癌┅侯犴铋呼疱铋轰彐狨祠疳翳箴邈┅换粕赝徕篝蜥泗犷礤蜱鏖翳躅轳蹂溟蝈泗矧ㄤ彐躅躅轳蹂骈戾钺礤疳翳钺礤镳糸镱犰磲泔躅卑鞍癌戾è溽翦疳螋ㄤ狒瀛篝犴皓┅祜镳蝈疱狒磲泔躅骘轭溴骝镯骘钺礤礤蜱瀛疳翳钺礤磲脲疳翳钺礤侯犴ㄦ矧磲铋岘岘洧疳翳钺礤钺礤疳翳钺礤溽翦疳螋轭溴┅疳翳钺礤滹躅戾篌痱镡瀛骈戾钺礤蝈趱蝾骝镯躅轳蹂骈戾钺礤钺礤┅ㄥ蝌矧⒄钺忪麸骈钿躅轳蹂疳翳钺礤骘峄翳弪狎犰蝈徜轰箝黹灬骈戾螈疳翳钺礤磲泔躅舂┅换粕赝徕篝蜥泗犷礤蜱鏖翳躅轳蹂骈戾钺礤ㄤ彐躅躅轳蹂溟蝈泗矧疳翳钺礤箦翩疳翳钺礤礤蜱瀛疳翳钺礤疳翳钺礤┅戾舄è溽翦疳螋ㄤ狒瀛篝犴皓灬篝溟蝈泗矧ㄦ轵篝灬篝疳翳钺礤溟蝈泗矧疳翳钺礤┅┅ㄢ狍瀛疳翳钺礤ㄣ镱翎轭轭绛疳翳钺礤疳翳钺礤┅ㄢ狍瀛钺礤疳翳钺礤钺礤灬篝溟蝈泗矧┅ㄢ狍瀛豉疱疳翳钺礤豉疱灬篝溟蝈泗矧┅矧祜镳蝈疱狒卑鞍骘轭溴骝镯骘钺礤礤蜱瀛疳翳钺礤磲脲疳翳钺礤侯犴铋呼疱铋轰轵邈麸蝙啜候屐狒轹ㄦ矧磲铋累岘蔺岘濑累狺茛忉箦钺礤溽翦疳螋轭溴忉箦豉疱┅忉箦疳翳钺礤滹躅戾篌痱镡瀛骈戾钺礤蝈趱蝾钺礤┅ㄥ蝌矧⒄钺忪麸骈钿躅轳蹂疳翳钺礤骘幄疳翳钺礤┅┅ㄤ彐躅溽翦篝犴é脲ㄤ狒弭轫ㄧ弭躅轹弪筢飙糸礤┅ㄩ钽祯溴糸礤铋飑眭祠轲戾鲠祯瀛忾钿箦泔钿黹铛翦栾躜溽盹铘遽溽镦翳瀛麇咫ㄤ邈镤瀛躅轹弪筢飙糸礤溽翦糸礤ㄤ邈灬蝈ㄩ珙矧溽镦翳瀛麇咫┅戾è溽翦疳螋ㄦ矧磲铋洵铂О洵铂О洧遽盹铘溽┅糸礤疳螋ㄡ钿轭沆蹁瀛糸礤扉篝ㄦ矧磲铋铂О洵铂О洵铂О洧栾躜黹铛翦箦泔钿┅┅ㄡ痧禊с镱汜翦钺翦篝蜷铉溽翦疳螋糸礤疳螋┅┅＋矧ㄤ狒瀛篝犴洪钽祯溴糸礤舂换换箬狎邃篝蹑换ㄤ彐珏铄蜷珏舡沆狍翳轭脲弪蝻蚩ê滹沲礤铘狒轱⒁弭躜铙翳沆狍镦翳轭矧铋殒翳沆狍汜铑雉忮骘躅洚澡轭汜忮沆狍蟋犷镡赍泗蝈痱弩孱糸铉沆狍矧簌礅镬钺黹铉沆狍螽清舡沆狍轶扉脲骈钿沆狍镱禊铒狍疳螋殂蹯狎ê礤翳镤è翳轭簌礅镬脲弪蝻蚩ㄦ轭洵沆狍翳轭弪蝻蚩┅ê礤翳镤è翳轭篝犷溽蜾镡赍泗脲弪蝻蚩ㄤ邈灬蝈ㄩ珙矧弪蝻蚩┅ㄣ灬篌镦翳轭绌ê礤翳镤è翳轭舂脲弪蝻蚩ㄤ邈灬蝈ㄩ珙矧弪蝻蚩┅ㄣ灬篌镦翳轭绌ê礤翳镤è翳轭沆狍螬脲弪蝻蚩ㄤ邈灬蝈ㄩ珙矧弪蝻蚩┅翳轭绌ㄤ彐躅溟蝈泗篚忏灬篌弩翳轭绌⒁弭躜铙翳轫礤溟狒篚忏灬篌弩镦翳轭绠澡轭汜忮沆狍蟋镡赍泗矧簌礅镬钺黹铉沆狍螽ㄣ灬篌溟蝈泗篚忏灬篌弩ㄧ弭沆狍翳轭绌┅ㄤ彐躅磲瓠篚忏灬篌弩ㄣ灬篌骖脲痱镳弪咯⒘痧扉弩骖麸遽汨篚忏灬篌镦沆狍螽涉痱镳弪轶趄蹂翳孱翳沆狍轸箦戽轶铒轭沆蹁邃轭翳磲痧轭绠序镳弪溴驷蹯趔麸铋飚戾è磲痧邃磲脲栳箬翎忪呼弩＇羼┅灬忮祗è磲痧邃ㄣ灬篌ㄧ弭栳箬沆狍磲痧邃┅ㄤ锃轸ㄣ灬篌蝻雉躅戾篌磲痧邃沆狍螬箦翩ㄧ弭栳箬沆狍磲痧邃舂躅戾篌ㄡ钿痱镳弪蝻雉ㄦ躅汜祆骖沆狍螬磲疸灬礅溽ㄣ灬篌ㄤ锃轸沆狍铋飑ㄤ轵邈舡篚忏灬篌弩沆狍螬┅┅ㄤ锃轸ㄧ弭沆狍沆狍螬舂┅ㄤ彐躅篚忏灬篌弩ㄣ灬篌脲痱镳弪舂⒁弭躜铙犰镦翳篚忏灬篌弩镦翳沆狍轭沆蹁轭翳沆狍轸箦戽戾è蝈篚祠铋飑磲瓠篚忏灬篌弩沆狍灬礅溽ㄣ灬篌瘐箬沆狍蝈篚祠┅吼蝻疱蚩痱镳弪咯铗弼弪箦蝈篚祠┅ㄤ彐躅篚疱蜚灬篌弩翳轭脲痱镳弪舂⒁弭躜铙扉篝镦篚疱蜚灬篌弩镦翳轭绠澡轭汜忮沆狍蟋镡赍泗矧簌礅镬钺黹铉沆狍螽澡扉篝镦沆狍箦蝈趱蝾邃轶ю蝻疱颛轸滹弩铒轭沆蹁翳沆狍轸箦戽戾è蝈篚祠ㄣ灬篌痱邈邃孱沐扉篝ㄧ弭沆狍翳轭绌┅ㄩ痱镳弪蝈篝蝈篚祠蝈篚祠┅＋矧换靠蝈盹鲥ㄤ彐躅溟蝈泗篚疱蜚灬篌弩翳轭绌⒁弭躜铙翳轫礤溟狒篚疱蜚灬篌弩镦翳轭绠澡轭汜忮沆狍蟋镡赍泗矧簌礅镬钺黹铉沆狍螽ㄣ灬篌溟蝈泗篚疱蜚灬篌弩ㄧ弭沆狍翳轭绌┅ㄤ邈灬轫ㄩ铎轭戾铉翳杯扉篝皓ㄤ彐躅戾铉翳杯扉篝⑸扉篝镦戾铉翳笨ㄡ钿ㄣ镱箴铛祆ㄣ潋┅┅ㄤ彐磲泸溴驺灬篌痱镳弪豉痱镳弪豉镳糸镱犰ㄤ彐狨祠铋溴驷蹯舡篚痧扉邃咯⒚蝈狒珏趑弪犷箦趑弪礤翳镤骘ю蝻疱螋镱簌礅镬痱镳弪豉扉篝螽戾è蝈犰钺礤ㄩ铘弪ㄦ矧磲铋豪窿痱镳弪豉弘妁黠蜾┅啜痱镧ㄤ彐珏铄蜷痱镳弪豉簌礅镬┅ㄤ彐珏铄蜷箦翩痱镳弪豉鲠祯簌礅镬┅ㄤ彐礤翳镤痱镳弪豉è沆狍蟓钺礤簌礅镬┅ㄧ弭沆狍蟓钺礤蝈犰钺礤括麒孱溴驷蹯舡篚痧扉邃扉篝溴驷蹯舂┅ㄤ彐礤翳镤箦翩痱镳弪豉鲠祯ㄣ灬篌钺礤簌礅镬┅箦翩ㄧ弭沆狍蟓钺礤蝈犰钺礤鲠祯濠┅┅ㄤ彐躅疳蝮瀛怛殄姝箪雉箪雉戾舄è箪雉箴邈豉疱汜箦箪雉簌礅镬扉篝箪雉┅扉篝箪雉ㄥ蝌矧⒂祜舡箴邈眭篝忮簌礅镬矧扉篝帼筻轶铒舢箪雉┅┅躅戾篌铛祆ㄣ滗箪雉箴邈┅ㄥ蝌矧⒂祜舡箴邈眭篝忮簌礅镬矧扉篝镦戾铉翳镱矧赭锂帼筻栳麸磲铢屐屙孱趔箪雉┅啜ㄦ轵篝箪雉箴邈括麒孱箦泔钿箪雉箴邈啜洪铋翩矧箦泔钿箪雉箴邈┅┅┅ㄤ彐躅泔铞弪舡沆狨箦蟓轭麸扉篝ㄣ灬躞弩犷洵镳糸镱沆狨箦蟓麸泔铞弪舂换澡轶轶躞彐蹯ㄦ矧礤狒戾狍簟骘黩轸轭磲泸矬戾è疳蝮邃沆狨箦铋飑ㄤ铼è沆狨箦沆狨箦蟓犷洵镳糸镱蝈篝沆狨箦螬ㄣ灬躞ㄦ轵篝沆狨箦螬ㄦ轵篝沆狨箦螬┅è铛祆沆狨箦螬ㄩㄡ钿脲黠蜾沆狨箦矧铛祆沆狨箦蟓麸泔铞弪舂礤礅弪沆狨箦沆狨箦蟓麸泔铞弪舂铒戾铉翳杯扉篝沆狨箦螬┅痱镧箦翩沆狨箦蝈篝沆狨箦螬瘐箬扉篝沆狨箦ㄦ轵篝沆狨箦螬疳蝮邃沆狨箦螬瘐箬沆狨箦疳蝮邃沆狨箦螬┅铗弼弪箦疳蝮邃沆狨箦螬┅ㄤ彐躅蝈盹鲥戾徜轭绛聃雉扉篝⒁屙秭弩翳骈蝮聃雉骝镯扉篝殒镱轶翳弪瀹ㄩㄡ钿ㄣ镱箴扉篝ㄥ耢ㄦ轵篝扉篝я躏翦┅ㄦ轵篝蝈篝扉篝┅扉篝┅ㄤ彐躅沆遽铛瓠疳蝮邃疳蜥礤翦疳蜥礤翦颟ㄩ戾铉翳杯扉篝疳蜥礤翦颟ㄦ轵篝疳蜥礤翦颟疳蜥礤翦颟ㄤ彐躅孱篚蝈篝蜷铉ㄩ舂ㄥ豉疱汜箦轸篝蜷铉轸簌礅镬簌礅镬钺礤轸┅┅